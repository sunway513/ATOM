Search.setIndex({"alltitles": {"1. AITER Integration Overview": [[8, "aiter-integration-overview"]], "1. Compilation Levels": [[3, "compilation-levels"]], "1. Master Configuration (Config)": [[4, "master-configuration-config"]], "1. OpenAI-Compatible Server": [[12, "openai-compatible-server"]], "1. Scheduling Algorithm": [[11, "scheduling-algorithm"]], "1. Supported Model Architectures": [[9, "supported-model-architectures"]], "1. System Overview": [[2, "system-overview"]], "1. Tensor Parallelism (TP)": [[5, "tensor-parallelism-tp"]], "1.1 Endpoints": [[12, "endpoints"]], "1.1 Scheduler Initialization": [[11, "scheduler-initialization"]], "1.2 Request Models": [[12, "request-models"]], "1.2 Schedule Flow": [[11, "schedule-flow"]], "1.3 Delay Factor": [[11, "delay-factor"]], "1.3 Response Models": [[12, "response-models"]], "1.4 Preemption": [[11, "preemption"]], "1.4 Server Startup": [[12, "server-startup"]], "1.5 Example: curl": [[12, "example-curl"]], "10. Fused Kernel Chains": [[8, "fused-kernel-chains"]], "2. CUDA Graph Modes": [[3, "cuda-graph-modes"]], "2. Compilation Configuration (CompilationConfig)": [[4, "compilation-configuration-compilationconfig"]], "2. Component Architecture": [[2, "component-architecture"]], "2. Data Parallelism (DP)": [[5, "data-parallelism-dp"]], "2. Linear Operations": [[8, "linear-operations"]], "2. Model Architecture Details": [[9, "model-architecture-details"]], "2. Programmatic API (LLMEngine)": [[12, "programmatic-api-llmengine"]], "2. ScheduledBatch Structure": [[11, "scheduledbatch-structure"]], "2.1 Class Hierarchy": [[8, "class-hierarchy"]], "2.1 Compilation Levels (CompilationLevel)": [[4, "compilation-levels-compilationlevel"]], "2.1 Constructor Signature": [[11, "constructor-signature"]], "2.1 Initialization": [[12, "initialization"]], "2.2 CompilationConfig Fields": [[4, "compilationconfig-fields"]], "2.2 Fields": [[11, "fields"]], "2.2 Quantization Dispatch": [[8, "quantization-dispatch"]], "2.2 SamplingParams": [[12, "samplingparams"]], "2.3 CUDA Graph Mode (CUDAGraphMode)": [[4, "cuda-graph-mode-cudagraphmode"]], "2.3 Core Methods": [[12, "core-methods"]], "2.3 ScheduledBatchOutput": [[11, "scheduledbatchoutput"]], "2.3 Tensor Parallel Sharding": [[8, "tensor-parallel-sharding"]], "2.4 Synchronous Generation Example": [[12, "synchronous-generation-example"]], "2.4 Weight Processing": [[8, "weight-processing"]], "2.5 Asynchronous / Streaming Usage": [[12, "asynchronous-streaming-usage"]], "3. Attention Operations": [[8, "attention-operations"]], "3. Block Manager": [[11, "block-manager"]], "3. CUDA Graph Capture": [[3, "cuda-graph-capture"]], "3. Expert Parallelism (EP)": [[5, "expert-parallelism-ep"]], "3. Quantization Configuration (QuantizationConfig)": [[4, "quantization-configuration-quantizationconfig"]], "3. Request Lifecycle": [[2, "request-lifecycle"]], "3. Simple Inference": [[12, "simple-inference"]], "3. Weight Loading": [[9, "weight-loading"]], "3.1 Base: Attention (base_attention.py)": [[8, "base-attention-base-attention-py"]], "3.1 Block Class": [[11, "block-class"]], "3.1 QuantizationConfig Fields": [[4, "quantizationconfig-fields"]], "3.1 Usage": [[12, "usage"]], "3.2 BlockManager Initialization": [[11, "blockmanager-initialization"]], "3.2 Multi-Head Attention (attention_mha.py)": [[8, "multi-head-attention-attention-mha-py"]], "3.2 QuantType Values (from AITER)": [[4, "quanttype-values-from-aiter"]], "3.2 What It Does": [[12, "what-it-does"]], "3.3 Allocation (allocate)": [[11, "allocation-allocate"]], "3.3 Multi-head Latent Attention (attention_mla.py)": [[8, "multi-head-latent-attention-attention-mla-py"]], "3.3 Supported Quantization Dtypes": [[4, "supported-quantization-dtypes"]], "3.4 Auto-Detection from HuggingFace (get_quant_config)": [[4, "auto-detection-from-huggingface-get-quant-config"]], "3.4 Backend Abstraction (attentions/backends.py)": [[8, "backend-abstraction-attentions-backends-py"]], "3.4 Deallocation (deallocate)": [[11, "deallocation-deallocate"]], "3.5 Can-Allocate and Can-Append Checks": [[11, "can-allocate-and-can-append-checks"]], "3.5 KV Cache Operations": [[8, "kv-cache-operations"]], "3.6 May-Append (Decode Extension)": [[11, "may-append-decode-extension"]], "4. Adding a New Model": [[9, "adding-a-new-model"]], "4. Benchmarking": [[12, "benchmarking"]], "4. Environment Variables": [[5, "environment-variables"]], "4. Forward Context Pattern": [[2, "forward-context-pattern"]], "4. Mixture of Experts (MoE)": [[8, "mixture-of-experts-moe"]], "4. Parallel Configuration (ParallelConfig)": [[4, "parallel-configuration-parallelconfig"]], "4. Piecewise Compilation": [[3, "piecewise-compilation"]], "4. Prefix Caching": [[11, "prefix-caching"]], "4.1 FusedMoE Class (moe.py)": [[8, "fusedmoe-class-moe-py"]], "4.1 Hash Function": [[11, "hash-function"]], "4.1 Metrics": [[12, "metrics"]], "4.2 Hash Chaining": [[11, "hash-chaining"]], "4.2 Key CLI Arguments": [[12, "key-cli-arguments"]], "4.2 Quantization Methods": [[8, "quantization-methods"]], "4.3 Backend Request Functions": [[12, "backend-request-functions"]], "4.3 Cache Lookup During Allocation": [[11, "cache-lookup-during-allocation"]], "4.3 TopK Routing (topK.py)": [[8, "topk-routing-topk-py"]], "4.4 Full Benchmark Example": [[12, "full-benchmark-example"]], "4.4 FusedMoEParallelConfig": [[8, "fusedmoeparallelconfig"]], "4.4 Reference Counting": [[11, "reference-counting"]], "4.5 Enabling Prefix Caching": [[11, "enabling-prefix-caching"]], "4.5 MORI Integration (fused_moe/mori_prepare_finalize.py)": [[8, "mori-integration-fused-moe-mori-prepare-finalize-py"]], "4.6 MoE Quantization Config (fused_moe/config.py)": [[8, "moe-quantization-config-fused-moe-config-py"]], "4.7 Triton MoE Fallback (fused_moe_triton.py)": [[8, "triton-moe-fallback-fused-moe-triton-py"]], "5. Forward Context & Stateless Dispatch": [[3, "forward-context-stateless-dispatch"]], "5. Model-Specific Optimizations": [[9, "model-specific-optimizations"]], "5. Multi-GPU Deployment Examples": [[5, "multi-gpu-deployment-examples"]], "5. Multi-Process Architecture": [[2, "multi-process-architecture"]], "5. Normalization": [[8, "normalization"]], "5. Postprocessing": [[11, "postprocessing"]], "5. Profiling": [[12, "profiling"]], "5. Speculative Decoding Configuration (SpeculativeConfig)": [[4, "speculative-decoding-configuration-speculativeconfig"]], "5.1 Configuration": [[12, "configuration"]], "5.1 RMSNorm (layernorm.py)": [[8, "rmsnorm-layernorm-py"]], "5.1 Signature": [[11, "signature"]], "5.2 LayerNorm (layernorm.py)": [[8, "layernorm-layernorm-py"]], "5.2 Online Profiling (HTTP)": [[12, "online-profiling-http"]], "5.2 Token Appending": [[11, "token-appending"]], "5.3 Programmatic Profiling": [[12, "programmatic-profiling"]], "5.3 Stop Condition Checking": [[11, "stop-condition-checking"]], "5.4 Offline Profiling Script": [[12, "offline-profiling-script"]], "5.4 Stream Output": [[11, "stream-output"]], "5.5 Profiling During Benchmarks": [[12, "profiling-during-benchmarks"]], "5.5 Sequence Cleanup": [[11, "sequence-cleanup"]], "5.6 Placeholder Insertion": [[11, "placeholder-insertion"]], "6. Activation Functions": [[8, "activation-functions"]], "6. Combined Parallelism Strategies": [[5, "combined-parallelism-strategies"]], "6. Compiler Backend": [[3, "compiler-backend"]], "6. Sampling Parameters (SamplingParams)": [[4, "sampling-parameters-samplingparams"]], "6. Sequence Lifecycle": [[2, "sequence-lifecycle"]], "6. Speculative Decoding (MTP)": [[12, "speculative-decoding-mtp"]], "6. Speculative Decoding Integration": [[11, "speculative-decoding-integration"]], "6.1 Architecture": [[12, "architecture"]], "6.1 Scheduler Tracking": [[11, "scheduler-tracking"]], "6.1 SiluAndMul (activation.py)": [[8, "siluandmul-activation-py"]], "6.2 Configuration": [[12, "id1"]], "6.2 Draft Tokens in Scheduling": [[11, "draft-tokens-in-scheduling"]], "6.3 Acceptance Statistics": [[11, "acceptance-statistics"]], "6.3 MTP Statistics": [[12, "mtp-statistics"]], "6.4 Draft Token Storage on Sequences": [[11, "draft-token-storage-on-sequences"]], "6.4 How Rejection Sampling Works": [[12, "how-rejection-sampling-works"]], "7. CLI Arguments (EngineArgs)": [[4, "cli-arguments-engineargs"]], "7. Configuration Options": [[3, "configuration-options"]], "7. Deployment Examples": [[12, "deployment-examples"]], "7. Embedding & Output Head": [[8, "embedding-output-head"]], "7. Sequence Management": [[11, "sequence-management"]], "7.1 Constructor": [[11, "constructor"]], "7.1 Single-GPU": [[12, "single-gpu"]], "7.1 VocabParallelEmbedding (embed_head.py)": [[8, "vocabparallelembedding-embed-head-py"]], "7.2 Core Fields": [[11, "core-fields"]], "7.2 Multi-GPU with Tensor Parallelism": [[12, "multi-gpu-with-tensor-parallelism"]], "7.2 ParallelLMHead (embed_head.py)": [[8, "parallellmhead-embed-head-py"]], "7.3 Docker Deployment": [[12, "docker-deployment"]], "7.3 Timing Fields": [[11, "timing-fields"]], "7.4 Computed Properties": [[11, "computed-properties"]], "7.4 Engine CLI Arguments (EngineArgs)": [[12, "engine-cli-arguments-engineargs"]], "7.5 num_tokens Setter": [[11, "num-tokens-setter"]], "7.6 Lifecycle": [[11, "lifecycle"]], "7.7 SequenceStatus Enum": [[11, "sequencestatus-enum"]], "7.8 SequenceType Enum": [[11, "sequencetype-enum"]], "8. Accuracy Validation": [[12, "accuracy-validation"]], "8. Decision Tree": [[3, "decision-tree"]], "8. Environment Variables": [[4, "environment-variables"]], "8. Rotary Position Embedding (RoPE)": [[8, "rotary-position-embedding-rope"]], "8.1 RotaryEmbedding (rotary_embedding.py)": [[8, "rotaryembedding-rotary-embedding-py"]], "8.1 Setup": [[12, "setup"]], "8.1 Variables Registered in atom/utils/envs.py": [[4, "variables-registered-in-atom-utils-envs-py"]], "8.2 Additional Environment Variables (Used Outside envs.py)": [[4, "additional-environment-variables-used-outside-envs-py"]], "8.2 Run Evaluation": [[12, "run-evaluation"]], "8.2 get_rope() Factory": [[8, "get-rope-factory"]], "8.3 Integration in Attention": [[8, "integration-in-attention"]], "9. Decision Tree \u2013 Choosing a Compilation Level": [[4, "decision-tree-choosing-a-compilation-level"]], "9. Sampling": [[8, "sampling"]], "9.1 Sampler (sampler.py)": [[8, "sampler-sampler-py"]], "9.2 RejectionSampler (rejection_sampler.py)": [[8, "rejectionsampler-rejection-sampler-py"]], "@support_torch_compile Decorator": [[3, "support-torch-compile-decorator"]], "AITER Kernel Mapping Table": [[8, "aiter-kernel-mapping-table"]], "API Reference": [[6, null]], "API Server": [[10, "api-server"]], "ATOM Architecture Guide": [[2, null]], "ATOM Compilation & CUDA Graphs Guide": [[3, null]], "ATOM Configuration Guide": [[4, null]], "ATOM Distributed Inference Guide": [[5, null]], "ATOM Documentation": [[6, null]], "ATOM Model Operations Guide": [[8, null]], "ATOM Model Support Guide": [[9, null]], "ATOM Scheduling & KV Cache Guide": [[11, null]], "ATOM Serving & Benchmarking Guide": [[12, null]], "AllReduce": [[5, "allreduce"]], "Architecture": [[5, "architecture"]], "Batch Inference": [[10, "batch-inference"]], "Cache Management": [[3, "cache-management"]], "Capture Flow": [[3, "capture-flow"]], "Common Configurations": [[3, "common-configurations"]], "Compilation Pipeline": [[3, "compilation-pipeline"]], "CompilerInterface": [[3, "compilerinterface"]], "CompilerManager": [[3, "compilermanager"]], "Configuration": [[5, "configuration"], [5, "id1"], [5, "id2"]], "Context Dataclass": [[3, "context-dataclass"]], "CoreManager (DP Orchestration)": [[5, "coremanager-dp-orchestration"]], "Custom Op Registration": [[3, "custom-op-registration"]], "DP Attention Mode": [[5, "dp-attention-mode"]], "DP Process Group Initialization": [[5, "dp-process-group-initialization"]], "DPMetadata": [[5, "dpmetadata"]], "DeepSeek MTP (DeepSeekMTP)": [[9, "deepseek-mtp-deepseekmtp"]], "DeepSeek V2/V3 (DeepseekV2ForCausalLM)": [[9, "deepseek-v2-v3-deepseekv2forcausallm"]], "DeepSeek V2/V3: MLA + Fused Input Norm + QK Norm Fusion": [[9, "deepseek-v2-v3-mla-fused-input-norm-qk-norm-fusion"]], "DeepSeek-R1 on 8 GPUs (TP8)": [[5, "deepseek-r1-on-8-gpus-tp8"]], "Default Capture Sizes": [[3, "default-capture-sizes"]], "Device Assignment": [[5, "device-assignment"]], "Distributed Serving": [[10, "distributed-serving"]], "Docker Installation": [[7, "docker-installation"]], "Dummy Batch Execution": [[5, "dummy-batch-execution"]], "Environment Variables": [[7, "environment-variables"]], "Example": [[1, "example"]], "Expert Distribution": [[5, "expert-distribution"]], "FULL (value: 2)": [[3, "full-value-2"]], "FULL_AND_PIECEWISE (value: (FULL, PIECEWISE))": [[3, "full-and-piecewise-value-full-piecewise"]], "FULL_DECODE_ONLY (value: (FULL, NONE))": [[3, "full-decode-only-value-full-none"]], "Features": [[6, "features"]], "ForwardContext Fields": [[3, "forwardcontext-fields"]], "From Source": [[7, "from-source"]], "Function Signature": [[9, "function-signature"]], "FusedMoEParallelConfig": [[5, "fusedmoeparallelconfig"]], "GLM4-MoE (Glm4MoeForCausalLM)": [[9, "glm4-moe-glm4moeforcausallm"]], "GPT Models": [[0, "gpt-models"]], "GPT-OSS (GptOssForCausalLM)": [[9, "gpt-oss-gptossforcausallm"]], "Getting Help": [[6, "getting-help"]], "Getting Started": [[6, null]], "Graph Keying": [[3, "graph-keying"]], "Graph Pool Sharing": [[3, "graph-pool-sharing"]], "Graph Replay in run_model()": [[3, "graph-replay-in-run-model"]], "Helper Methods": [[3, "helper-methods"]], "Indices and tables": [[6, "indices-and-tables"]], "InductorAdaptor": [[3, "inductoradaptor"]], "InductorStandaloneAdaptor": [[3, "inductorstandaloneadaptor"]], "Installation": [[7, null]], "Installation Methods": [[7, "installation-methods"]], "Integration with CUDA Graphs": [[3, "integration-with-cuda-graphs"]], "Kimi-K2-Thinking on 4 GPUs (TP4)": [[5, "kimi-k2-thinking-on-4-gpus-tp4"]], "LLM Class": [[1, "llm-class"]], "Layers Beyond num_hidden_layers": [[9, "layers-beyond-num-hidden-layers"]], "Level 0 \u2013 NO_COMPILATION": [[3, "level-0-no-compilation"]], "Level 1 \u2013 DYNAMO_AS_IS": [[3, "level-1-dynamo-as-is"]], "Level 2 \u2013 DYNAMO_ONCE": [[3, "level-2-dynamo-once"]], "Level 3 \u2013 PIECEWISE (Production Default)": [[3, "level-3-piecewise-production-default"]], "Lifecycle": [[3, "lifecycle"]], "Llama (LlamaForCausalLM)": [[9, "llama-llamaforcausallm"]], "Llama Models": [[0, "llama-models"]], "Llama: Fused RMSNorm+Quant and SiLU+Mul+Quant": [[9, "llama-fused-rmsnorm-quant-and-silu-mul-quant"]], "Loading Flow": [[9, "loading-flow"]], "MORI Communication": [[5, "mori-communication"]], "MTP: DeepSeek Multi-Token Prediction": [[9, "mtp-deepseek-multi-token-prediction"]], "Methods": [[1, "methods"]], "Mixtral": [[0, "mixtral"]], "Mixtral (MixtralForCausalLM)": [[9, "mixtral-mixtralforcausallm"]], "Model Configuration": [[0, "model-configuration"]], "NONE (value: 0)": [[3, "none-value-0"]], "Next Steps": [[10, "next-steps"]], "Other Architectures": [[0, "other-architectures"]], "PIECEWISE (value: 1)": [[3, "piecewise-value-1"]], "Performance Tips": [[10, "performance-tips"]], "Performance by Model Size": [[0, "performance-by-model-size"]], "Process Group Initialization": [[5, "process-group-initialization"]], "Quantization": [[0, "quantization"]], "Quick Links": [[6, "quick-links"]], "Quick Reference": [[4, "quick-reference"], [5, "quick-reference"], [8, "quick-reference"], [9, "quick-reference"], [11, "quick-reference"], [12, "quick-reference"]], "Quickstart": [[10, null]], "Qwen3 (Qwen3ForCausalLM)": [[9, "qwen3-qwen3forcausallm"]], "Qwen3-235B-A22B on 8 GPUs (TP8 + EP)": [[5, "qwen3-235b-a22b-on-8-gpus-tp8-ep"]], "Qwen3-MoE (Qwen3MoeForCausalLM)": [[9, "qwen3-moe-qwen3moeforcausallm"]], "Qwen3-MoE: QK Norm + RoPE + Cache + Quant Fusion": [[9, "qwen3-moe-qk-norm-rope-cache-quant-fusion"]], "RequestOutput": [[1, "requestoutput"]], "Requirements": [[7, "requirements"]], "SamplingParams": [[1, "samplingparams"]], "Serving API": [[1, null]], "Serving a Model": [[10, "serving-a-model"]], "Source Files": [[2, "source-files"], [3, "source-files"], [4, "source-files"], [5, "source-files"], [8, "source-files"], [9, "source-files"], [11, "source-files"], [12, "source-files"]], "Splitting Operations": [[3, "splitting-operations"]], "Step 1: Create the Model File": [[9, "step-1-create-the-model-file"]], "Step 2: Implement Layer Classes": [[9, "step-2-implement-layer-classes"]], "Step 3: Implement the Model and CausalLM Classes": [[9, "step-3-implement-the-model-and-causallm-classes"]], "Step 4: Register the Model": [[9, "step-4-register-the-model"]], "Step 5: Handle Weight Loading": [[9, "step-5-handle-weight-loading"]], "Supported GPUs": [[6, "supported-gpus"]], "Supported Models": [[0, null]], "Synchronized Busy Loop": [[5, "synchronized-busy-loop"]], "TP + DP (Dense Throughput)": [[5, "tp-dp-dense-throughput"]], "TP + DP + EP (MoE Throughput)": [[5, "tp-dp-ep-moe-throughput"]], "TP + EP (MoE Models)": [[5, "tp-ep-moe-models"]], "TP Only (Dense Models)": [[5, "tp-only-dense-models"]], "Troubleshooting": [[7, "troubleshooting"]], "User Guides": [[6, null]], "Verification": [[7, "verification"]], "VllmBackend": [[3, "vllmbackend"]], "Weight Sharding": [[5, "weight-sharding"]], "atom/model_ops/": [[8, "atom-model-ops"]], "atom/model_ops/attentions/": [[8, "atom-model-ops-attentions"]], "atom/model_ops/fused_moe/": [[8, "atom-model-ops-fused-moe"]], "atom/utils/": [[8, "atom-utils"]], "generate()": [[1, "generate"]]}, "docnames": ["api/models", "api/serving", "architecture_guide", "compilation_cudagraph_guide", "configuration_guide", "distributed_guide", "index", "installation", "model_ops_guide", "model_support_guide", "quickstart", "scheduling_kv_cache_guide", "serving_benchmarking_guide"], "envversion": {"sphinx": 64, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1}, "filenames": ["api/models.rst", "api/serving.rst", "architecture_guide.md", "compilation_cudagraph_guide.md", "configuration_guide.md", "distributed_guide.md", "index.rst", "installation.rst", "model_ops_guide.md", "model_support_guide.md", "quickstart.rst", "scheduling_kv_cache_guide.md", "serving_benchmarking_guide.md"], "indexentries": {}, "objects": {}, "objnames": {}, "objtypes": {}, "terms": {"": [0, 2, 3, 4, 5, 6, 8, 9, 11, 12], "0": [1, 2, 4, 5, 8, 9, 10, 11, 12], "00": [11, 12], "04_py3": 12, "1": [0, 1, 6], "10": [6, 12], "100": [1, 10, 12], "1000": [11, 12], "1024": [8, 12], "127": [4, 5, 12], "128": [4, 5, 6, 7, 8, 12], "12_pytorch_release_2": 12, "13b": 0, "16": [0, 3, 4, 5, 11, 12], "16384": [4, 5, 11, 12], "16g": 12, "192": 6, "1e": [8, 9], "1x": 0, "1x32": 8, "2": [0, 1, 6, 10], "20": 10, "200": 1, "20000": 5, "25": 12, "2507": 5, "256": [4, 9, 12], "29500": [4, 5], "2_ubuntu24": 12, "2d": 4, "2x": 0, "3": [0, 6, 7], "30b": 0, "32": [0, 3, 4, 8, 12], "3750": 11, "4": [0, 6, 10], "4096": 10, "40b": 0, "4250": 12, "48": [3, 4], "496": 3, "4x": 0, "5": [6, 7, 10], "50": [1, 10, 12], "5000": [11, 12], "512": [3, 4, 11, 12], "6": 6, "64": [0, 3, 4, 5, 11, 12], "67108864": 12, "6b": [0, 4, 12], "7": [1, 5, 6, 7], "70b": [0, 10], "75": [11, 12], "7b": [0, 1, 10], "7b1": 0, "8": [0, 1, 6, 7], "8000": [10, 12], "8006": [4, 12], "8192": 0, "85": 12, "8b": [0, 5, 12], "8x22b": 0, "8x7b": 0, "9": [1, 6, 10, 11, 12], "92": 4, "95": [1, 10], "99": 12, "A": [2, 3, 9, 11], "By": 8, "For": [0, 3, 4, 5, 8, 9, 11, 12], "If": [2, 3, 4, 5, 8, 9, 11, 12], "In": [5, 11], "It": [3, 8, 11], "Its": 8, "No": [3, 4, 7, 8, 9], "Not": [3, 9], "On": [3, 5, 8, 11, 12], "One": 11, "The": [2, 3, 4, 5, 8, 9, 10, 11, 12], "These": [3, 5, 9, 11, 12], "To": 2, "With": 8, "_": 11, "__call__": 3, "__getattr__": 5, "__init__": [3, 5, 11, 12], "__post_init__": [3, 4, 5], "__version__": 7, "_a1": 8, "_a2": 8, "_deallocate_block": 11, "_dynamo": 3, "_execute_dummy_batch": 5, "_execute_dummy_prefil": 5, "_fuse_qkv_a_proj_reduce_rmsnorm_quant_fp4": 9, "_fuse_rmsnorm_fp4_qu": 9, "_fuse_rmsnorm_qu": 9, "_fused_rms_fp8_group_qu": 9, "_inductor": 3, "_init_data_parallel": 5, "_num_token": 11, "_passed_delai": 11, "_process_engine_step": 2, "_q_proj_and_k_up_proj": 8, "_set_cudagraph_s": 3, "_sync_dp_stat": 5, "_tp": 12, "_v_up_proj_and_o_proj": 8, "_w1": 8, "_w2": 8, "a1": 5, "a16": 8, "abbrevi": 12, "about": [1, 10], "abov": [4, 9], "absent": 4, "abstract": 3, "acceler": [2, 6], "accept": [3, 4, 5, 8, 12], "acceptance_r": 12, "accepted_token_id": 11, "access": [2, 3, 4, 7], "accessor": 2, "accumul": 11, "accuraci": [6, 9], "across": [2, 3, 4, 5, 8, 9, 11], "activ": [2, 3, 5, 6, 9, 11], "activation_schem": 4, "activationtyp": 8, "ad": 6, "adapt": [5, 12], "adaptor": 3, "add": [3, 7, 8, 9, 11, 12], "add_cli_arg": [4, 12], "add_request": [2, 12], "addit": [3, 11], "addition": 9, "address": [3, 4, 5, 12], "adjust": 11, "advanc": 3, "after": [2, 3, 5, 8, 9, 11, 12], "against": [8, 9, 11, 12], "aggreg": 5, "agre": 5, "ai": [4, 5, 12], "aiter": [2, 3, 5, 6, 9, 11, 12], "aiter_attent": 8, "aiter_lib": 3, "aiter_mla": 8, "aiter_quick_reduce_quant": 5, "aiterattentionmetadatabuild": 8, "aiterbackend": 8, "aitermlabackend": 8, "aitermlametadatabuild": 8, "algorithm": 6, "alia": [9, 12], "align": 5, "all": [2, 3, 4, 5, 8, 9, 11, 12], "all_reduc": [2, 5, 8], "allgath": 5, "alloc": [2, 9], "allow": [3, 8, 11], "allreduc": [8, 9], "along": 5, "alreadi": [3, 11], "also": [3, 4, 9, 11, 12], "altern": 9, "alwai": [3, 8, 11], "alwayshitshapeenv": 3, "amd": [0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12], "an": [2, 3, 5, 8, 9, 11, 12], "analysi": 3, "ani": [3, 5, 11, 12], "anoth": 2, "anyth": 4, "api": 2, "api_serv": 10, "appear": 11, "append": [2, 8, 12], "append_token": 11, "appendleft": 11, "appli": [3, 8, 9, 12], "applic": [9, 12], "appropri": [5, 8], "approxim": 12, "ar": [2, 3, 4, 5, 7, 8, 9, 11, 12], "architectur": [4, 6, 7, 10], "arg": 12, "arg_util": [4, 5, 12], "argmax": [8, 12], "argument": [3, 5, 6], "arrai": 11, "arrive_tim": [2, 11], "artifact": 3, "ascend": 3, "asm": 8, "asm_mo": 8, "assembl": 2, "assert": [3, 5], "assign": [4, 8, 11], "async": [4, 12], "async_proc": 2, "async_request_deepspeed_mii": 12, "async_request_func": 12, "async_request_openai_chat_complet": 12, "async_request_openai_complet": 12, "async_request_tgi": 12, "async_request_trt_llm": 12, "asyncio": 4, "asyncio_mod": 4, "asyncioproc": 2, "asyncioprocmanag": 2, "atom": [0, 1, 7, 10], "atom_": 4, "atom_cach": 7, "atom_cache_dir": 7, "atom_config": 2, "atom_debug": 3, "atom_disable_mmap": 9, "atom_dp_": 5, "atom_dp_master_ip": [4, 5], "atom_dp_master_port": [4, 5], "atom_dp_rank": [4, 5], "atom_dp_rank_loc": [4, 5], "atom_dp_s": [4, 5], "atom_enable_allreduce_rmsnorm_fus": [4, 9], "atom_enable_ds_input_rmsnorm_quant_fus": [4, 9], "atom_enable_ds_qknorm_quant_fus": [4, 9], "atom_enable_qk_norm_rope_cache_quant_fus": [4, 5, 9], "atom_enforce_eag": [4, 5], "atom_llama_enable_aiter_triton_fused_rmsnorm_qu": [4, 9], "atom_llama_enable_aiter_triton_fused_silu_mul_qu": [4, 9], "atom_max_batch_s": 7, "atom_profiler_mor": [4, 12], "atom_torch_profiler_dir": [4, 12], "atom_use_triton_gemm": [4, 8], "atom_use_triton_mxfp4_bmm": [4, 8], "attempt": 3, "attent": [2, 3, 4, 6, 9, 12], "attention_mla": 9, "attentionbackend": 8, "attentionimpl": 8, "attentionmetadata": [2, 3], "attentionmetadatabuild": 8, "attn_metadata": [2, 3], "attn_metadata_build": 3, "attribut": [1, 9], "augment": 3, "authent": 4, "auto": [2, 3, 11], "autoconfig": 9, "automat": [3, 4, 5, 9, 12], "autoregress": [2, 12], "auxiliari": 9, "avail": [4, 5, 7, 8, 9, 12], "averag": 12, "avoid": 11, "await": 2, "awq": 0, "b": [3, 12], "back": [2, 3, 4, 5, 8, 9, 11], "backbon": 9, "backend": [2, 4, 5, 6, 9], "backend_nam": 3, "backend_request_func": 12, "balanc": [5, 9], "bar": 3, "base": [2, 3, 4, 5, 9, 10, 11, 12], "base_attent": 9, "base_config": 8, "base_url": 12, "basic": 3, "batch": [0, 2, 3, 4, 6, 8, 11, 12], "batch_descriptor": 3, "batch_siz": [2, 3], "batchdescriptor": 3, "batched_gemm_a16wfp4": 8, "batched_gemm_a8w8_a_per_token_group_prequant_w_per_batched_tensor_qu": 8, "becaus": 3, "befor": [2, 3, 4, 5, 8, 11, 12], "begin": 4, "behavior": 3, "behaviour": 4, "being": [2, 11], "below": 4, "benchmark": [4, 6, 10], "benchmark_serv": 12, "benchmark_util": 12, "benchmarkmetr": 12, "benefit": 3, "best": 4, "better": 11, "between": [3, 12], "bf16": [4, 8, 12], "bfloat16": [0, 1, 4], "bia": [8, 9], "bias": 8, "biased_grouped_topk": 8, "bind": 12, "bit": 4, "block": [2, 3, 4, 5, 6, 8, 9, 12], "block_id": 11, "block_manag": [2, 11], "block_num": 5, "block_siz": [8, 10, 11], "block_tabl": [2, 11], "blockmanag": 2, "bloom": 0, "bmm": [8, 9], "bonu": [2, 8, 12], "bool": [1, 3, 4, 5, 8, 9, 11, 12], "boolean": 4, "bos_token_id": [4, 11], "both": [3, 8, 9, 11, 12], "boundari": [2, 5], "break": 11, "buffer": [3, 4, 8], "build": [2, 3, 4, 7], "built": [2, 4, 6, 7, 9, 12], "burstgpt": 12, "bursti": 12, "busy_loop": [2, 5], "bypass": 3, "bytecod": 3, "ca_fp8_quant": 5, "cach": [2, 4, 5, 6, 10, 12], "cache_dir": [3, 4], "cache_miss": 11, "call": [2, 3, 5, 8, 9, 11, 12], "callabl": [2, 3, 11], "callback": [2, 11], "can": [2, 3, 5, 12], "can_alloc": 11, "can_append": 11, "candid": 3, "cannot": [3, 11], "cap": [4, 12], "capit": [10, 12], "captur": [2, 4, 6, 8, 12], "capture_cudagraph": 3, "carri": [3, 11], "case": 9, "cat": 8, "caus": 3, "cd": [7, 12], "cdna": 6, "ceil": 8, "central": 2, "chain": 6, "chang": 3, "channel": [3, 4], "chat": [0, 12], "chatcmpl": 12, "chatcompletionrequest": 12, "chatcompletionrespons": 12, "chatmessag": 12, "check": [2, 3, 12], "checkpoint": 9, "chines": 12, "choic": [4, 12], "choos": 6, "chrome": 12, "chunked_s": 2, "ck": 8, "cl": 11, "class": [2, 3, 4, 5, 6, 12], "classmethod": 11, "clean": 11, "cleaner": 3, "clear": [2, 11], "cli": [5, 6], "client": [11, 12], "clone": [7, 12], "cmpl": 12, "co": 8, "co_nam": 3, "code": [3, 4, 5, 12], "codellama": 0, "collect": [2, 5], "collis": 11, "column": [5, 8], "columnparallellinear": [5, 8, 9], "com": [6, 7, 12], "combin": [3, 6, 8, 9], "comma": 12, "command": 2, "comment": 3, "common": [5, 9, 11], "commonattentionbuild": 8, "commun": [2, 4, 6, 8, 9, 12], "compar": [8, 11, 12], "compat": [2, 3, 6, 9], "compil": [6, 8, 10, 12], "compilation_config": [3, 4, 8], "compilation_level": 3, "compilationconfig": [2, 3, 6, 12], "compilationlevel": 3, "compile_fx": 3, "compile_s": [3, 4], "compiled_cal": 3, "compiled_graph_for_general_shap": 3, "compiler_config": 3, "compiler_inferfac": 3, "complet": [1, 2, 11, 12], "completion_token": 12, "completion_token_id": 11, "completionrequest": 12, "completionrespons": 12, "compon": [6, 8, 9], "comprehens": 12, "compress": [4, 8, 9, 12], "compressedtensorsfp8moemethod": 8, "comput": [2, 3, 4, 5, 8, 9, 12], "computation_graph": 3, "compute_hash": [3, 11], "compute_logit": [3, 9], "conc": 12, "concat": 8, "concat_and_cache_mla": 8, "concaten": 9, "concept": 3, "concrete_size_entri": 3, "concretesizeentri": 3, "concurr": [9, 12], "condit": [2, 8], "config": [2, 3, 5, 6, 9, 11, 12], "configur": [1, 2, 6, 7, 8, 10], "connect": [2, 9], "constant": 4, "construct": [5, 8, 11], "constructor": 8, "consum": 4, "contain": [2, 3, 7, 9, 12], "content": [11, 12], "context": [4, 6, 11, 12], "context_len": 11, "continu": [2, 4], "control": [1, 2, 3, 4, 8, 9], "convent": 9, "convers": 8, "convert": 4, "convert_to_pytorch_benchmark_format": 12, "coordin": 5, "coordinate_descent_tun": 3, "copi": [3, 4, 5, 8], "copy_": 5, "core": [2, 9], "coremanag": 2, "correct": [3, 5, 9], "correctli": 9, "correspond": [2, 9], "cos_sin_cach": 9, "cosin": 9, "count": [2, 3, 5, 9, 12], "cover": [9, 11, 12], "cpu": [3, 5], "cpu_group": 5, "creat": [2, 3, 4, 5, 11, 12], "create_engin": [4, 12], "creation": [3, 5, 8], "critic": [2, 3], "cross": [2, 5, 9], "cu_seqlens_q": [3, 8], "cu_tokens_across_dp_cpu": 5, "cuda": [2, 5, 6, 12], "cuda_graph": 3, "cuda_graph_s": [3, 4], "cuda_piecewise_backend": 3, "cudagraph": [3, 4, 6, 10, 12], "cudagraph_capture_s": [3, 4], "cudagraph_copy_input": [3, 4], "cudagraph_mod": [3, 4], "cudagraph_runtime_mod": 3, "cudagraphentri": 3, "cudagraphmod": 3, "cudagraphopt": 3, "cudagraphwrapp": 3, "cumul": [2, 5, 8], "current": [2, 3, 4, 8, 9, 11, 12], "custom": [0, 8, 9, 12], "custom_regist": 3, "cycl": 11, "d": [3, 4, 12], "data": [2, 3, 4, 6, 8, 12], "data_parallel_base_port": 4, "data_parallel_master_ip": 4, "data_parallel_master_port": 4, "data_parallel_rank": [4, 5], "data_parallel_rank_loc": [4, 5], "data_parallel_s": [2, 4, 5, 12], "data_parallel_size_loc": 4, "dataclass": [2, 4, 5, 8, 11, 12], "dataset": 12, "dealer": [2, 5], "dealloc": 2, "debug": [3, 4], "debug_dump_path": [3, 4], "decid": 3, "decis": 6, "decod": [2, 3, 5, 6, 8, 9], "decode_mod": [3, 4], "decoder_sparse_step": 9, "decompil": 3, "decor": [8, 9], "dedic": [2, 9], "deepgemm_fp8_paged_mqa_logit": 9, "deepseek": [2, 4, 8, 12], "deepseek_mtp": [4, 9], "deepseek_v2": [2, 9], "deepseekmtp": 12, "deepseekmtpmodel": [4, 12], "deepseekmultitokenpredictor": 9, "deepseekmultitokenpredictorlay": 9, "deepseekv2decoderlay": 9, "deepseekv2forcausallm": 2, "deepseekv2mlaattent": 9, "deepseekv2mlp": 9, "deepseekv2mo": 9, "deepseekv2model": 9, "deepseekv32forcausallm": [2, 9], "deepseekv3forcausallm": [2, 9], "deepspe": 12, "def": [3, 5, 8, 9, 11], "default": [1, 4, 5, 8, 9, 11, 12], "default_weight_load": 9, "defer": [2, 11], "defin": [2, 3, 4, 8, 9, 12], "definit": [4, 5, 12], "delai": [4, 12], "delay_factor": 11, "deleg": [3, 8, 9], "demand": 12, "dens": 9, "depend": [7, 8, 11], "deploi": 5, "deploy": [3, 6], "dequ": [2, 11], "deriv": [4, 11], "descend": 3, "describ": [3, 8], "descript": [2, 3, 4, 5, 8, 9, 11, 12], "descriptor": [2, 4], "deseri": 2, "design": 2, "detail": [4, 6, 12], "detect": [3, 9], "determin": [3, 4, 5, 11], "determine_expert_map": 5, "determinist": 4, "detoken": 2, "dev": [7, 12], "develop": [3, 4, 7], "deviat": 12, "devic": [7, 12], "dict": [2, 3, 4, 9, 11, 12], "dictionari": [2, 3, 4, 9, 12], "differ": [3, 4, 5, 8, 9, 11], "digest": 11, "dim": [5, 8], "dimens": [3, 5, 8], "dir": [4, 12], "direct": [2, 3], "direct_register_custom_op": 3, "directli": [3, 9], "directori": [3, 4, 9, 12], "disabl": [1, 4, 5, 9, 11, 12], "disable_cach": 3, "disaggreg": 3, "discard": 12, "discov": 9, "discuss": 6, "disk": 3, "dispatch": [2, 5, 6, 9], "dispatch_a1": 5, "dispatch_backend": 8, "dispatch_id": 5, "dispatch_kei": 3, "dispatch_recv_token_num": 5, "dispatch_scal": 5, "dispatch_to_cod": 3, "dispatch_weight": 5, "dist": 5, "distribut": [2, 4, 6], "distributed_init_method": 5, "divid": [3, 8], "do": [4, 5], "do_not_compil": 3, "doc": 6, "document": [4, 8], "doe": [2, 3, 4, 5], "done": [2, 11, 12], "down": 9, "down_proj": [8, 9], "download": [4, 9], "download_weights_from_hf": 9, "dp": [2, 3, 4, 6, 8, 12], "dp_group": 5, "dp_metadata": [2, 3], "dp_rank": [5, 8, 12], "dp_rank_loc": 5, "dp_size": [5, 8], "dp_size_": 5, "dpenginecoreproc": [2, 5], "dpmetadata": [2, 3], "draft": [2, 3, 4, 8, 9, 12], "draft_id": 11, "draft_model_hf_config": 4, "draft_token_id": 11, "drafter": 3, "dri": [7, 12], "drive": 11, "dtype": [0, 1, 5, 8, 9, 12], "due": 8, "dummi": [2, 3, 11], "dummy_prefill_execut": 2, "dump": [3, 4], "duplic": 9, "dure": [3, 4, 8, 9], "dynam": [3, 4, 8], "dynamo": [3, 4], "dynamo_as_i": 4, "dynamo_onc": 4, "e": [3, 4, 5, 8, 9, 11, 12], "e2el": 12, "e4m3": 4, "e4m3fn": 8, "e4m3fnuz": 8, "e8m0": 8, "e8m0_shuffl": 8, "e_score_correction_bia": 9, "each": [2, 3, 5, 8, 9, 11, 12], "eager": [3, 4, 12], "eagerli": [2, 3], "eagl": [2, 12], "eagle3": 9, "eaglepropos": [2, 12], "earli": 8, "earlier": 3, "earliest": 11, "earliest_arrival_tim": 11, "effect": [3, 4, 5], "effici": 5, "eh_proj": 9, "either": [3, 8, 9], "elapsed_tim": 3, "element": [3, 9], "eleutherai": 0, "elimin": [2, 9], "els": [3, 4, 5, 11], "embed": [6, 9], "embed_head": 9, "embed_token": 9, "empti": [3, 4, 11], "enabl": [2, 3, 4, 5, 8, 9, 10, 12], "enable_dp_attent": [4, 5], "enable_expert_parallel": [4, 5], "enable_prefix_cach": [4, 11, 12], "enable_think": 12, "end": [4, 12], "enforc": [4, 11, 12], "enforce_eag": [3, 4], "engin": [2, 4, 5, 8, 9, 11], "engine_cor": [2, 5], "engine_core_mgr": [2, 5], "enginearg": [5, 6], "enginecor": [2, 5], "enginecorerequesttyp": 2, "english": 12, "enorm": 9, "enough": 11, "ensur": [2, 3, 5, 7, 9, 11], "enter": [2, 11], "entir": [3, 11], "entri": [8, 9, 11], "entrypoint": [4, 5, 10, 12], "enum": [2, 3, 4], "env": [5, 9, 12], "environ": [2, 3, 6, 9, 12], "eo": [2, 4, 11, 12], "eos_token_id": [4, 11], "ep": [4, 6, 8, 9], "ep_rank": [5, 8], "ep_siz": [5, 8], "eplb": 9, "equal": 4, "error": 3, "etc": [2, 3, 6, 8, 9, 11], "eval": 12, "evalu": [3, 4, 5], "even": 9, "evenli": 8, "event": 12, "everi": [3, 4, 5, 8, 9, 11, 12], "evict": 11, "exactli": [4, 9, 11], "exampl": [0, 3, 4, 6, 9], "example_input": 3, "exclud": [4, 12], "exclude_lay": 4, "exclus": 9, "execut": [2, 3, 4, 9, 12], "exist": [4, 9, 11, 12], "exit": 5, "exit_engin": [2, 11], "expect": [3, 4], "experiment": 6, "expert": [0, 4, 6, 9, 12], "expert_id": 9, "expert_map": 5, "experttokensmetadata": 8, "explain": 12, "explicit": [3, 4], "exponenti": 8, "export": [5, 7], "expos": [4, 12], "extend": [4, 5, 8, 11], "extens": 9, "extra": 9, "extract": [3, 8, 9], "extract_layer_index": 9, "f": [1, 5, 7, 8, 10], "face": 2, "factor": [4, 9, 12], "factori": 12, "fake": 3, "fake_impl": 3, "falcon": 0, "fall": [3, 4, 9, 11], "fallback": 9, "fals": [3, 4, 5, 8, 9, 11, 12], "famili": 0, "fast": 11, "fastapi": 12, "featur": 9, "feed": 2, "field": [2, 9, 12], "file": 6, "filenam": [3, 12], "fill": 11, "filter": 9, "filter_duplicate_safetensors_fil": 9, "final": [3, 5, 8, 9], "finish": [1, 2, 11], "finish_reason": [11, 12], "finished_seq": 11, "first": [2, 3, 8, 11, 12], "first_k_dense_replac": 9, "first_token_tim": [2, 11], "fit": 2, "fix": [11, 12], "flag": [2, 4, 5, 8, 9], "flash": 8, "flash_attn_varlen_func": 8, "flatten": 5, "flatten_tp_across_dp": 5, "flexibl": 4, "float": [1, 2, 4, 8, 11, 12], "float16": 1, "float32": 1, "flow": [2, 8], "flush": 12, "follow": [2, 3, 8, 9, 11], "forc": [3, 4], "form": 11, "format": [0, 3, 8, 12], "formula": 5, "forward": [5, 6, 8, 9, 11, 12], "forward_context": [2, 3, 5], "forward_var": 3, "forwardcontext": [2, 5], "found": [4, 7, 11], "four": [3, 4, 5, 12], "fp16": 8, "fp4": [4, 8, 9], "fp4_util": 8, "fp4x2": [4, 8], "fp8": [4, 5, 8, 9, 12], "fp8_mqa_logit": 9, "fp8_w8a8_moe_quant_config": 8, "fp8moemethod": 8, "fraction": [4, 11], "framework": [6, 12], "franc": [10, 12], "free": 11, "free_block_id": 11, "freed": 11, "frequenc": 1, "frequency_penalti": 1, "frequent": 3, "fresh": 11, "from": [0, 1, 2, 3, 5, 8, 9, 10, 11, 12], "from_cli_arg": 12, "front": 11, "frozen": 11, "full": [2, 4, 5, 8, 9, 11], "full_and_piecewis": 4, "full_decode_onli": 4, "fullgraph": 3, "fulli": [5, 6, 11], "function": [2, 3, 6], "fuse": [4, 5, 6], "fused_add_rmsnorm_pad": 8, "fused_add_rmsnorm_pad_": 8, "fused_allreduc": 8, "fused_expert_output": 5, "fused_fp4_bmm_rope_cat_and_cache_mla": 8, "fused_fp8_bmm_rope_cat_and_cache_mla": 8, "fused_gemm_a8w8_blockscale_preshuffle_split_cat": 8, "fused_gemm_afp4wfp4_preshuffle_split_cat": 8, "fused_mo": 5, "fused_moe_bf16_asm": 8, "fused_moe_unquantized_config": 8, "fused_qk_norm_rope_cache_quant_shuffl": 8, "fused_qk_rope_concat_and_cache_mla": 8, "fused_qk_rope_reshape_and_cach": 8, "fused_qu": [8, 9], "fused_reduce_act_mul_and_mxfp4_qu": 8, "fused_rms_fp8_per_tensor_static_qu": 8, "fused_rms_mxfp4_qu": 8, "fused_rmsnorm_pad_": 8, "fused_silu_mul_fp8_per_tensor_static_qu": 8, "fusedmo": [5, 9], "fusedmoeconfig": 8, "fusedmoemethodbas": 9, "fusedmoemodularkernel": 8, "fusedmoeprepareandfin": 8, "fusedmoequantconfig": 8, "fusedmoequantdesc": 8, "fusion": [4, 5, 8], "fwd_output": 11, "g": [3, 4, 5, 8, 9, 11, 12], "gate": [4, 5, 8, 9, 11], "gate_proj": 9, "gate_up": 8, "gate_up_proj": [8, 9], "gate_up_proj_block": 9, "gather": [2, 5, 8], "gb": 6, "gc": 3, "gelu": 8, "gemm": [4, 8, 9], "gemm_a16wfp4_preshuffl": 9, "gemm_a4w4": 8, "gemm_a8w8": 8, "gemm_a8w8_blockscale_bpreshuffl": 8, "gemm_a8w8_bpreshuffl": 8, "gemm_afp4wfp4_preshuffl": 9, "gener": [2, 3, 4, 8, 9, 10, 11], "generate_stream": 12, "generation_config": 4, "generationconfig": 4, "get": [10, 11, 12], "get_attn_backend": 8, "get_builder_cl": 8, "get_dp_group": 5, "get_dp_pad": 3, "get_eagle3_aux_hidden_state_lay": 9, "get_expert_map": 9, "get_forward_context": [2, 3], "get_generation_config": 4, "get_hf_config": 4, "get_hip_qu": 8, "get_impl_cl": 8, "get_nam": 8, "get_open_port": 4, "get_pp_group": 5, "get_quant_config_for_lay": 9, "get_rop": 9, "get_tp_group": 5, "getenv": 4, "gfx": 7, "gfx90a": [6, 7], "gfx942": [6, 7], "gfx94x": 8, "gfx950": 6, "gguf": 9, "git": [7, 12], "github": [6, 7, 12], "given": 8, "glanc": 3, "glm4_moe": [2, 9], "glm4mixtureofexpert": 9, "glm4moe": 9, "glm4moeattent": 9, "glm4moedecoderlay": 9, "glm4moeforcausallm": 2, "glm4moemlp": 9, "glm4moemodel": 9, "global": [2, 3, 4, 5, 8], "global_num_expert": 5, "gloo": [2, 5], "gluon": 8, "goe": 9, "goodput": 12, "gpt": 6, "gpt_oss": [2, 9], "gptossforcausallm": 2, "gptossmodel": 9, "gptq": 0, "gpu": [0, 1, 2, 3, 4, 7, 8, 9, 10, 11], "gpu_arch": 7, "gpu_memory_util": [1, 4, 10, 11, 12], "gqa": 9, "grace": 5, "granular": 4, "graph": [2, 5, 6, 8, 12], "graph_b": [2, 3, 4], "graph_index": 3, "graph_kei": 3, "graph_pool": 3, "greedi": [8, 12], "greedy_sampl": 8, "grep": 7, "group": [2, 4, 7, 8, 9, 12], "group_siz": 4, "grouped_topk": 8, "groupshap": 8, "gsm8k": 12, "guard": [3, 11], "guid": 10, "gumbel": 8, "gzip": 12, "h": [11, 12], "ha": [2, 3, 5, 9, 11], "had": 11, "half": 8, "handl": [2, 3, 5, 8], "happen": 5, "hardwar": 8, "has_full_cudagraph": [3, 4], "has_unfinish": 5, "hash": 3, "hash_to_block_id": 11, "have": [8, 9, 11, 12], "hbm2e": 6, "hbm3": 6, "head": [5, 6, 9], "head_dim": [8, 9], "head_siz": 8, "health": 12, "heavi": [5, 8], "hello": [10, 12], "helper": [4, 8], "hf": [0, 1, 9, 10, 12], "hf_config": [4, 9], "hf_token": 4, "hidden": [2, 8, 9], "hidden_s": 8, "hidden_st": 3, "hierarchi": 2, "high": 6, "highest": 3, "highli": 3, "hip": [2, 4, 5, 8, 9, 11, 12], "hip_visible_devic": 5, "hipblaslt": 8, "hit": 11, "hnorm": 9, "hold": [2, 3, 5, 8, 11], "home": 12, "hook": 3, "host": [7, 10, 12], "how": [3, 4, 5, 9], "http": [6, 7, 10], "hub": 9, "huggingfac": [1, 2, 9, 12], "human": 4, "hybrid": 4, "i": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "i4x2": 4, "i8": 4, "id": [1, 2, 3, 4, 5, 8, 9, 11, 12], "ident": 11, "identif": 3, "identifi": [2, 3, 8, 12], "idl": 2, "ignor": [4, 11, 12], "ignore_eo": [4, 11, 12], "imag": [7, 12], "immedi": 11, "immut": 11, "impl_cl": 8, "implement": [2, 3, 8, 11, 12], "import": [0, 1, 2, 3, 5, 7, 8, 9, 10, 12], "importerror": 7, "impract": 3, "improv": 5, "includ": [2, 4, 12], "incom": 5, "incompat": [3, 4], "incorpor": 11, "increas": 10, "increment": [2, 11], "independ": [3, 5], "index": [5, 6, 8, 9], "index_topk": 9, "indic": [2, 3, 9], "individu": 3, "inductor": [3, 4], "inductor_compile_config": [3, 4], "inf": 12, "infer": [2, 3, 4, 6, 8, 9, 11], "inference_mod": 3, "inform": [3, 4], "infrastructur": 8, "inherit": [8, 9], "init": [4, 11], "init_aiter_topk_meta_data": 8, "init_dist_env": [2, 5], "init_prepare_fin": 9, "init_with_cudagraph_s": 3, "initi": [1, 2, 3, 4, 8, 9], "initialize_cach": 3, "input": [1, 2, 3, 4, 5, 8, 12], "input_address": 5, "input_id": 3, "input_layernorm": 9, "input_queu": 2, "inputoutputprocessor": 2, "insid": [5, 12], "inspect": 3, "inspir": 2, "instal": [6, 12], "instanc": [3, 8], "instanti": [5, 8, 9], "instead": [4, 5, 12], "instinct": [6, 7], "instruct": 5, "int": [1, 2, 3, 4, 5, 8, 11, 12], "int32": 5, "int4": [4, 5], "int64": 5, "int8": [4, 8], "intdigest": 11, "integ": [3, 4, 11], "integr": 6, "inter": [2, 12], "interfac": [3, 12], "interfer": 5, "intermedi": 8, "intermediate_s": 8, "intermediatetensor": 9, "intern": [3, 4, 8, 9, 12], "internlm": 9, "intra": 5, "invalid": 3, "invok": [3, 9], "io": 6, "ip": [4, 5], "ipc": [2, 5, 7], "is_avail": 7, "is_draft": [2, 3], "is_dummy_run": 11, "is_dynam": 4, "is_finish": [11, 12], "is_neox_styl": 8, "is_prefil": [2, 3, 5], "is_rocm_aiter_fp4bmm_en": 9, "is_rocm_aiter_fuse_routed_scaling_factor": 9, "is_rocm_aiter_fusion_shared_expert_en": [8, 9], "isl": 12, "isol": 5, "issu": 6, "iter": [4, 9, 11, 12], "itertool": 11, "itl": 12, "its": [2, 5, 11], "itself": 8, "j": 0, "join": 9, "joint": 9, "json": [9, 10, 12], "just": 11, "k": [1, 4, 5, 8, 9], "k_nope": 8, "k_norm": [8, 9], "k_proj": 9, "k_rope": 8, "keep": [2, 4], "kei": [2, 4, 5, 8, 9, 11], "kept": 9, "kernel": [2, 3, 4, 5, 6, 9, 12], "key_": 8, "keyword": 12, "kfd": [7, 12], "know": 9, "kv": [2, 3, 4, 5, 6, 9, 10, 12], "kv_b_proj": 8, "kv_c_norm": 8, "kv_cache_block_s": [4, 11], "kv_cache_data": [2, 3], "kv_cache_dtyp": [4, 5, 12], "kv_lora_rank": [8, 9], "kvcacheconfig": 4, "kvcachetensor": [2, 3, 4], "kwarg": 12, "larg": [2, 4, 5], "largest": [3, 10], "last": [8, 9, 11], "last_block_num_token": 11, "last_prompt_lat": 11, "last_token": 11, "latenc": [3, 4, 12], "latency_": 12, "latent": 9, "later": 7, "latest": 7, "launch": [2, 3, 4, 5, 8, 12], "layer": [2, 3, 4, 5, 8], "layer_nam": 8, "layer_typ": 9, "layernorm": 9, "layernorm2d_fwd": 8, "layernorm2d_fwd_with_add": 8, "lazi": [4, 5], "lazili": [3, 5], "ld_library_path": 7, "learnabl": 9, "leav": 3, "leave_reason": 11, "leave_tim": [2, 11], "len": [4, 5, 11, 12], "length": [1, 2, 3, 4, 8, 11, 12], "level": [2, 5, 6, 8, 9, 11, 12], "lib": 7, "librari": [2, 3, 7, 8, 11], "lifecycl": 6, "lifetim": 11, "lightweight": [2, 4, 9, 12], "like": [3, 4, 5, 9], "limit": 4, "linear": [5, 6, 9], "linearbas": [5, 8], "list": [1, 2, 3, 4, 8, 11, 12], "littl": 11, "live": 9, "llama": [1, 2, 4, 5, 6, 8, 10, 12], "llamaattent": 9, "llamadecoderlay": 9, "llamaforcausallm": 2, "llamamlp": 9, "llamamodel": 9, "llm": [0, 2, 4, 5, 6, 8, 9, 10, 11, 12], "llm_engin": [2, 12], "llmengin": [2, 4, 6], "lm": [8, 9, 12], "lm_eval": 12, "lm_head": 9, "lmdeploi": 12, "load": [1, 2, 3, 4, 5, 6, 8, 10, 12], "load_dummi": [4, 9, 12], "load_model": 9, "loader": 9, "local": [3, 4, 5, 8, 12], "local_device_rank": 5, "local_dp_rank": 5, "local_engine_count": 5, "local_ep_s": [5, 8], "local_has_unfinish": 5, "local_is_prefil": 5, "local_num_expert": 5, "local_num_token": 5, "local_shutdown": 5, "localhost": [10, 12], "lockstep": 2, "log": [11, 12], "logdir": 12, "logic": 8, "logit": [2, 3, 8, 9], "longer": 11, "look": [3, 4, 11], "lookup": 3, "loop": [2, 4], "lora": 9, "low": 3, "lower": 4, "m": [4, 5, 10, 12], "mai": 3, "main": [1, 2, 9], "maintain": [3, 9, 11], "make": [3, 4, 5, 12], "make_compil": 3, "make_empty_intermediate_tensors_factori": 9, "make_expert_params_map": 9, "make_lay": 9, "manag": [2, 4, 5, 6, 9], "mani": 12, "manual": 8, "map": [2, 3, 4, 5, 9, 11], "mark": 3, "mark_dynam": 3, "mark_spliting_op": 8, "mask": 8, "master": [2, 6], "master_addr": 4, "match": [4, 9, 11, 12], "matmul": 5, "matmul_og": 8, "matrix": 4, "matter": 3, "max": [3, 4, 5, 8, 11, 12], "max_autotun": 3, "max_cudagraph_mod": 3, "max_model_len": [0, 1, 4, 10, 12], "max_num_batched_token": [2, 4, 10, 11], "max_num_seq": [2, 3, 4, 11], "max_posit": 8, "max_position_embed": [4, 8], "max_q_len": 3, "max_retri": 12, "max_seqlen_q": 3, "max_token": [1, 2, 4, 10, 11, 12], "max_tokens_across_dp": [2, 5], "max_tokens_across_dp_cpu": 5, "maximum": [1, 2, 3, 4, 5, 11, 12], "may_append": 11, "maybe_prefix": 9, "md": 5, "me": [1, 10], "mean": [5, 11, 12], "measur": [6, 10, 11], "mechan": [3, 12], "median": 12, "meet": 12, "memlock": 12, "memori": [0, 1, 3, 4, 5, 6, 8, 9, 10, 11, 12], "merg": [5, 8], "mergedcolumnparallellinear": [5, 8, 9], "mergedreplicatedlinear": 8, "messag": [2, 12], "met": [2, 11], "meta": [0, 1, 5, 10, 12], "metadata": [2, 3, 5, 8, 9, 11], "method": [4, 5, 6, 9, 11], "mha": 8, "mi200": 7, "mi250x": [0, 6], "mi300": 7, "mi300a": 6, "mi300x": [0, 6], "microsc": 4, "mii": 12, "min": 11, "minim": 3, "minut": 10, "mismatch": [8, 12], "miss": [3, 11], "mistral": [0, 9], "mistralai": 0, "mix": [3, 4, 9, 11], "mixed_mod": [3, 4], "mixed_sample_outer_exponenti": 8, "mixin": 9, "mixtral": [2, 6, 8], "mixtralattent": 9, "mixtraldecoderlay": 9, "mixtralforcausallm": 2, "mixtralmo": 9, "mixtralmodel": 9, "mixtur": [0, 6, 9], "mla": [5, 8], "mla_attent": [3, 4], "mla_decode_fwd": 8, "mla_prefill_fwd": 8, "mlaattent": 8, "mlamodul": [8, 9], "mlp": 9, "mlp_only_lay": 9, "mlpblock": 9, "mm": 8, "mnt": 12, "mode": [6, 8, 11], "model": [1, 2, 3, 4, 6, 11], "model_arg": 12, "model_engin": [2, 3, 4, 5, 9, 11, 12], "model_load": 9, "model_name_or_path": [9, 12], "model_op": [5, 9, 12], "model_runn": [2, 3, 4, 5, 9, 12], "model_typ": 4, "modelrunn": [2, 3, 5, 9, 12], "modif": [3, 12], "modifi": 3, "modul": [2, 3, 7, 8, 9], "modular": 8, "modular_kernel": 8, "modulo": 11, "moe": [2, 4, 6, 12], "monkei": 3, "more": [2, 3, 4, 9, 11], "mori_op": [5, 8], "mori_prepare_fin": 5, "moriprepareandfin": [5, 8], "most": [3, 4, 11], "move": [2, 11], "mpt": 0, "mqa": 9, "mtp": [2, 3, 4, 6, 8, 11], "mtp_block": 9, "mtp_k": [3, 11], "mul": 8, "multi": [3, 4, 6, 10, 11], "multipl": [2, 4, 5, 8, 11], "multipli": [4, 8, 9], "multiprocess": [2, 5], "must": [3, 4, 5, 8, 9, 11, 12], "mutates_arg": 3, "mxfp4": [4, 5, 8, 9], "mxfp4_act_mul_quant_fus": 8, "mxfp4_w4a16_moe_quant_config": 8, "mxfp4moemethod": 8, "my": 10, "my_callback": 12, "my_fake_impl": 3, "my_kernel": 3, "my_model": 9, "my_op": 3, "mymodel": 9, "mymodelattent": 9, "mymodeldecoderlay": 9, "mymodelforcausallm": 9, "mymodelmlp": 9, "n": [3, 4, 5, 8, 10, 12], "n_group": 9, "n_predict": 4, "n_routed_expert": 9, "name": [1, 3, 4, 7, 9, 10, 12], "namespac": 3, "nativ": [2, 12], "nccl": [2, 5], "need": [3, 4, 9, 11], "need_placehold": 11, "nemo": 9, "neox": [0, 9], "network": 12, "new": [2, 3, 6, 11], "newli": 11, "next": [4, 6, 9, 11, 12], "nn": [3, 8, 9], "no_compil": 4, "no_compile_lay": 3, "node": [5, 6, 8], "non": [3, 5, 9, 11, 12], "none": [4, 5, 8, 11, 12], "norm": [4, 5, 8], "normal": [3, 6, 9, 11], "normalize_e4m3fn_to_e4m3fnuz": 8, "note": [3, 4, 9, 11, 12], "now": 11, "np": 11, "nucleu": [1, 12], "num": [4, 5, 12], "num_accepted_token": 11, "num_batched_token": 11, "num_bit": 4, "num_block": 11, "num_bonus_token": 8, "num_cached_block": 11, "num_cached_token": 11, "num_completion_token": 11, "num_concurr": 12, "num_embed": 8, "num_expert": 8, "num_fewshot": 12, "num_head": 8, "num_kv_head": [5, 8], "num_kvcache_block": [4, 11], "num_new_token": 11, "num_nextn_predict_lay": 4, "num_partit": 8, "num_placehold": 11, "num_prompt_token": [2, 11], "num_scheduled_token": 11, "num_seqs_prefil": 11, "num_spec_step": 11, "num_speculative_token": [4, 11, 12], "num_token": [2, 3, 5, 8], "num_tokens_across_dp": [2, 5], "num_tokens_input": 12, "num_tokens_output": 12, "num_tokens_tensor": 5, "number": [1, 3, 4, 5, 8, 11, 12], "o": [2, 4, 8, 11], "o_proj": 8, "oaiattent": 9, "object": [2, 3, 12], "occur": 11, "ocean": 10, "ok": 12, "onc": [3, 11, 12], "one": [2, 3, 4, 8, 9], "onli": [3, 4, 8, 9, 11, 12], "onto": 11, "onward": 9, "op": [4, 5, 8], "op_func": 3, "op_nam": 3, "openai": 6, "openai_serv": [5, 12], "oper": [2, 5, 6, 9], "opt": [7, 12], "optim": [0, 2, 3, 4, 5, 6, 8, 11, 12], "option": [2, 4, 6, 8, 9, 11, 12], "orchestr": [2, 3, 8, 11], "order": [3, 11], "origin": [2, 5, 9], "osl": 12, "other": [2, 5, 6, 9], "otherwis": [4, 8, 11], "out": [2, 3, 8, 12], "output": [1, 2, 3, 4, 5, 6, 9, 10, 12], "output_address": 5, "output_queu": 2, "output_s": 8, "output_token": 11, "output_token_id": 8, "output_tokens_list": 11, "outputs_queu": 2, "outsid": 3, "over": [2, 9, 11], "overhead": [2, 3, 5, 9], "overrid": [2, 3, 4, 5, 9], "overridden": 4, "overs": 3, "overview": 6, "own": [2, 5, 8], "owner": 5, "p": [3, 4], "p99": 12, "pa_decode_gluon": 8, "pa_fwd_asm": 8, "pa_persistent_fwd": 8, "pack": [4, 5, 9], "packed_modules_map": 9, "pad": [3, 5, 8], "page": [4, 6, 8, 9, 11], "paged_attention_asm": 8, "paged_attention_persistent_asm": 8, "paged_attention_triton": 8, "pair": [4, 12], "parallel": [0, 1, 2, 3, 6, 9, 10], "parallel_config": [4, 5], "parallel_st": 5, "parallelconfig": [2, 5, 6], "parallellmhead": 9, "param": [1, 12], "param_nam": 9, "paramet": [1, 2, 3, 6, 8, 9], "pars": [4, 12], "parser": 4, "part": 3, "partial": [5, 9, 11], "particip": 5, "particularli": 3, "partit": [5, 8], "pass": [2, 3, 4, 9, 11, 12], "passed_delai": 11, "past": 4, "patch": 3, "path": [0, 1, 3, 4, 7, 8, 11, 12], "pattern": [3, 6, 8, 9], "peek": 11, "penalti": 1, "pend": [2, 11, 12], "per": [2, 3, 4, 5, 8, 9, 11, 12], "per_128x128": 4, "per_1x128": [4, 8], "per_1x32": [4, 8], "per_tensor": [4, 8], "per_tensor_dequant": 8, "per_token": [4, 8], "percentil": 12, "perform": [3, 4, 5, 6, 8, 9], "persist": 8, "pg": 5, "phase": [2, 5, 8, 11], "pick": 11, "pickl": 2, "piecewis": [4, 6], "piecewisebackend": 3, "piecewisecompileinterpret": 3, "pip": [7, 12], "pipelin": [8, 9], "place": [2, 8, 9, 11], "placehold": 9, "plain": 5, "platform": 6, "plu": [11, 12], "point": [4, 11], "poisson": 12, "polici": 11, "pool": 11, "pop": 11, "popul": 4, "port": [4, 5, 10, 12], "posit": [2, 3, 6, 9, 11], "post": [4, 9, 10, 12], "post_attention_layernorm": 9, "postprocess": [2, 6], "postprocessor": 11, "pp": [4, 9], "ppmissinglay": 9, "pprint": 3, "pre": [2, 3, 5, 7, 8, 9, 11], "preced": [8, 11], "precis": 9, "precomput": [8, 9], "predefin": 12, "predict": [2, 3, 4, 11, 12], "preempt": [2, 11], "prefer": 3, "prefil": [2, 3, 4, 5, 8, 11], "prefill_attent": 8, "prefill_q_p": 8, "prefix": [2, 3, 4, 6, 9, 12], "prepar": [2, 3, 5, 8], "prepare_model": 2, "preprocess": 2, "presenc": 1, "presence_penalti": 1, "present": 8, "preserv": 11, "pretrainedconfig": 4, "prev_block": 11, "prev_prompt": 11, "prev_tim": 11, "prevent": 8, "previou": [2, 4, 9, 11], "previous": 3, "primari": 4, "primarili": 3, "principl": 2, "print": [1, 7, 10, 12], "print_mtp_statist": 12, "prior": 11, "priorit": 2, "prioriti": 11, "proce": 11, "process": [4, 6, 9, 11, 12], "process_input_socket": 2, "process_weights_after_load": [8, 9], "produc": [8, 9, 11, 12], "product": 4, "profil": [3, 4, 6], "profile_memori": [4, 12], "profile_offlin": 12, "profiler_dir": 12, "profiler_trac": 12, "programmat": [4, 5, 6], "progress": 3, "project": [5, 8, 9], "prompt": [1, 2, 4, 10, 11, 12], "prompt_or_tokens_list": 12, "prompt_token": 12, "prompt_token_id": 11, "properti": [2, 4, 5, 8], "proportion": 5, "propos": [2, 11, 12], "protocol": [2, 12], "provid": [3, 4, 5, 8, 9, 11, 12], "pull": [2, 5, 7, 12], "pull_and_process_input_queu": 2, "pure": [3, 4, 5], "purpos": [2, 3, 4, 5, 8, 11], "push": [2, 5, 11], "put": 11, "put_nowait": 11, "py": [2, 3, 5, 7, 9, 11, 12], "python": [3, 4, 5, 7, 10, 11, 12], "python3": 7, "pytorch": [2, 3, 4, 7, 12], "q": [5, 8, 9], "q_lora_rank": [8, 9], "q_norm": [8, 9], "q_pe": 8, "q_proj": [8, 9], "qk": [4, 5, 8], "qk_head_dim": 8, "qk_nope_head_dim": [8, 9], "qk_rope_head_dim": [8, 9], "qkv": 9, "qkv_proj": 9, "qkvparallellinear": [5, 8, 9], "quant": [4, 5, 8], "quant_config": [4, 8], "quant_dtyp": 4, "quant_method": [4, 8, 9], "quant_nam": 4, "quant_typ": [4, 8], "quantiz": [5, 6, 9], "quantization_config": 4, "quantizationconfig": [2, 6, 8, 9], "quantizemethodbas": 8, "quanttyp": 8, "quantum": 12, "quark": 4, "queri": [3, 9, 10], "query_": 8, "queu": 2, "queue": [2, 11], "quick": [2, 3], "quickstart": 6, "qwen": [4, 5, 12], "qwen3": [2, 4, 8, 12], "qwen3_mo": [2, 9], "qwen3attent": 9, "qwen3decoderlay": 9, "qwen3forcausallm": 2, "qwen3mlp": 9, "qwen3model": 9, "qwen3moeattent": 9, "qwen3moedecoderlay": 9, "qwen3moeforcausallm": 2, "qwen3moemlp": 9, "qwen3moemodel": 9, "qwen3moesparsemoeblock": 9, "r": 7, "r1": [4, 12], "rais": [3, 4], "random": [1, 8, 12], "random_sampl": 8, "rang": [0, 3, 4, 6, 8, 11, 12], "rank": [2, 3, 4, 5, 8, 9, 12], "rank_": [3, 12], "rank_0": [3, 12], "rankid": 5, "rate": [11, 12], "rather": [2, 3, 5], "ratio": 12, "re": 11, "read": [3, 4, 5, 9], "readabl": 4, "readi": 5, "readm": 5, "real": [3, 5], "reason": 11, "receipt": 12, "receiv": [2, 5, 9, 11], "recent": 11, "recip": 5, "recommend": [0, 3, 4], "record": [2, 3, 11], "record_shap": [4, 12], "recurs": 7, "reduc": [0, 2, 4, 5, 8, 9, 11], "reduce_result": [5, 8], "reduceop": 5, "reducescatt": 5, "redund": 11, "ref_count": 11, "refer": [2, 3], "referenc": 11, "refus": 3, "regardless": [3, 11], "region": 3, "regist": [2, 3, 8, 11], "registr": 8, "registri": 9, "reject": [2, 8], "rejection_greedy_sample_kernel": [8, 12], "rejection_sampl": 12, "rejectionsampl": [2, 12], "relat": [3, 11], "releas": 11, "remain": [5, 8], "remap": [4, 9], "remot": [4, 5, 8, 12], "remov": 11, "renam": 9, "rendezv": 5, "renorm": 8, "repeat": [3, 10], "repeatedli": 2, "replac": [3, 11, 12], "replai": [2, 4], "replic": [5, 8], "replica": 5, "replicatedlinear": [5, 8, 9], "report": 12, "repositori": 7, "repres": 11, "represent": 8, "req_id": 11, "requant": 8, "requantize_with_max_scal": 8, "request": [1, 4, 5, 6, 10, 11], "request_id": 11, "request_output": 11, "requestfuncinput": 12, "requestfuncoutput": 12, "requestoutput": [2, 6, 11, 12], "requir": [2, 3, 4, 5, 6, 8, 11, 12], "requires_piecewise_compil": [3, 4], "reserv": 11, "reset": [3, 11], "reset_forward_context": [2, 3], "reshap": 8, "reshape_and_cach": 8, "reshape_and_cache_with_pertoken_qu": 8, "reshuffl": 8, "residu": [8, 9], "residual_out": 8, "resist": 11, "resolut": 9, "resolv": 9, "respect": 5, "respons": 10, "rest": 10, "result": [2, 3, 5, 8, 12], "result_filenam": 12, "retriev": [2, 3, 12], "return": [1, 2, 3, 4, 5, 8, 9, 11, 12], "reus": [3, 4, 11], "revers": 11, "rewrit": 9, "rewrite_spec_layer_nam": 9, "rewritten": 9, "right": 3, "rm": 8, "rmsnorm": 4, "rmsnorm2d_fwd": 8, "rmsnorm2d_fwd_with_add": 8, "robin": [2, 5], "rocm": [2, 4, 5, 6, 7, 8, 9, 11, 12], "rocm7": 12, "rocm_aiter_biased_grouped_topk": 8, "rocm_aiter_grouped_topk": 8, "rocm_aiter_topk_softmax": 8, "rocm_path": 7, "rocminfo": 7, "role": 12, "root": 4, "rope": [4, 5, 6], "rope_cach": 8, "rope_cached_positions_2c_fwd_inplac": 8, "rope_sc": 8, "rotari": [6, 9], "rotary_dim": 8, "rotary_emb": 8, "rotary_embed": 9, "rotate_styl": 8, "round": [2, 5], "rout": [5, 9], "router": [2, 5, 8, 9], "routin": 4, "row": [5, 8], "rowparallellinear": [5, 8, 9], "rule": 4, "run": [2, 3, 4, 5, 7, 8, 11], "run_engin": 5, "run_model": 2, "runner": [3, 5, 11], "runtim": [3, 4, 12], "runtime_mod": 3, "runtime_shap": 3, "runtimeerror": 7, "safetensor": 9, "safetensors_weights_iter": 9, "safeti": 3, "same": [3, 4, 5, 8, 9], "sampl": [1, 2, 6, 11], "sampled_token": 8, "sampler": 2, "sampling_param": [1, 4, 11, 12], "sampling_params_list": 12, "samplingparam": [2, 6, 11], "satisfi": 5, "save": [3, 4, 12], "scale": [4, 5, 8, 9], "scale_a": 8, "scale_b": 8, "scalellm": 12, "schedul": [2, 4, 5, 6, 12], "scheduled_spec_decode_token": 11, "scheduled_token": 11, "scheduledbatch": [2, 6], "scheduledbatchoutput": 2, "scheduler_delay_factor": [4, 11], "scheme": 4, "score": 9, "sdk": 12, "search": 6, "seccomp": 12, "second": [3, 8, 12], "section": [3, 4, 12], "secur": 12, "see": [3, 4, 12], "seed": 12, "select": [3, 5, 8, 9], "select_expert": 8, "selector": 8, "self": [3, 5, 8, 11, 12], "send": [2, 5, 12], "sent": [2, 11, 12], "sentinel": [2, 11], "separ": [5, 8, 9, 12], "separate_routin": [3, 4], "seq": [4, 11, 12], "seq_id": 11, "seq_len": 11, "sequenc": [1, 3, 4, 6, 8, 12], "sequencestatu": 2, "sequencetyp": 2, "sequenti": 8, "seri": 7, "serial": [2, 3], "serv": [3, 5, 6, 7, 9, 11], "server": 6, "set": [2, 3, 4, 5, 8, 9, 10, 11, 12], "set_current_atom_config": 4, "set_forward_context": [2, 3], "set_kv_cache_data": 2, "set_splitting_ops_for_v1": 3, "set_weight_attr": 9, "setup": [3, 4, 7], "sever": [3, 9], "sglang": 12, "shape": [3, 8], "shard": 9, "shard_id": 9, "share": [4, 8, 9, 11], "shared_expert": 9, "sharedhead": 9, "sharegpt": 12, "ship": 12, "shm": 12, "short": 4, "shot": 4, "should": 3, "should_ignore_lay": 9, "shuffl": [8, 9], "shuffle_weight": 8, "shutdown": [2, 5, 11], "side": [3, 5], "sigmoid": 9, "signal": [2, 5, 11, 12], "signatur": [3, 12], "silent": 3, "silu": [4, 8], "silu_and_mul": 8, "siluandmul": 9, "simpl": [6, 9], "simple_infer": 12, "simplest": 3, "sin": 8, "sinc": [3, 5, 11], "sine": 9, "singl": [2, 3, 4, 5, 8, 9, 11], "sink": 9, "size": [2, 4, 5, 6, 8, 10, 11, 12], "skip": [3, 4, 9, 11, 12], "slice": [5, 9], "slide": 9, "sliding_window": 8, "slo": 12, "slot": [2, 8, 11], "small": [3, 4], "smi": 7, "snapshot": 11, "so": [3, 4, 5, 9, 11, 12], "socket": [2, 5], "softmax": 8, "some": 3, "sonnet": 12, "sort": 3, "sourc": 6, "space": 11, "span": 5, "spars": [8, 9], "spawn": 2, "spec_decod": [9, 12], "spec_decode_metadata": [2, 3], "spec_token_id": [2, 11], "specdecodemetadata": [2, 3], "special": [3, 11], "specif": [2, 3, 6, 12], "specifi": [3, 12], "specul": [2, 3, 6, 8, 9], "speculative_config": [4, 11], "speculativeconfig": [2, 6, 11, 12], "split": [4, 5, 8], "split_gm": 3, "split_graph": 3, "splititem": 3, "splitting_op": [3, 4], "spmd": 4, "spread": 5, "squeezellm": 0, "sse": 12, "stabil": 3, "stack": 12, "stage": 9, "stai": [2, 4, 5], "standalon": 8, "standalone_compil": 3, "standard": [3, 8, 9, 12], "start": [4, 9, 10, 12], "start_monitoring_torch_compil": 3, "start_profil": 12, "startup": [3, 11], "stat": [2, 11, 12], "state": [2, 3, 5, 9, 11], "state_tensor": 5, "stateless": [2, 6], "stateless_init_dp_group": 5, "stateless_init_torch_distributed_process_group": 5, "static": [3, 4, 5, 8], "static_forward_context": [3, 8], "staticmethod": 5, "statist": 2, "statu": [2, 6, 11, 12], "step": [2, 3, 4, 5, 6, 11, 12], "sticki": 11, "still": [4, 5, 11], "stitch": 3, "stop": [2, 4, 12], "stop_": 11, "stop_profil": 12, "stop_sequ": 11, "stop_str": [4, 11, 12], "stop_token_id": [4, 11], "stop_token_sequ": 11, "storag": 3, "store": [3, 4, 11], "str": [1, 2, 3, 4, 5, 9, 11, 12], "strategi": [2, 3, 4, 6], "stream": [2, 3], "stream_callback": [2, 11, 12], "stream_output_queu": 11, "string": [2, 3, 4, 8, 9, 11, 12], "struct": 2, "structur": [2, 6, 8, 9], "style": [0, 8, 9, 12], "sub": 4, "subclass": [8, 9], "subdirectori": 12, "subgraph": 3, "submiss": 12, "submit": [2, 9, 12], "submodul": 3, "subprocess": 2, "subsequ": [3, 11, 12], "subset": 5, "succe": 3, "success": 12, "suitabl": 3, "sum": [2, 11], "sunway513": 6, "suppli": 4, "support": [2, 3, 5, 7, 8, 11, 12], "support_model_arch_dict": [2, 9], "support_torch_compil": 9, "swiglu": [8, 9], "switch": 4, "sync": 5, "synchron": [2, 3], "sys_ptrac": 12, "system": [3, 6], "t": 11, "tabl": [2, 3, 4, 11], "tail": 11, "take": 9, "target": [2, 4, 8, 11, 12], "target_argmax": 8, "target_logit": 8, "task": 12, "tell": [1, 10], "temperatur": [1, 2, 4, 8, 11, 12], "templat": 12, "ten": 2, "tensor": [0, 1, 2, 3, 4, 6, 9, 10], "tensor_model_parallel_all_gath": 8, "tensor_model_parallel_fused_allreduce_rmsnorm": 8, "tensor_parallel_s": [0, 1, 4, 5, 10, 12], "tensorboard": 12, "tensorrt": 12, "term": 12, "termin": 12, "test": [4, 12], "text": [1, 10, 12], "text_complet": 12, "tgemm": 8, "tgi": 12, "than": [2, 3, 5, 11], "theblok": 0, "thei": [2, 3, 5, 12], "them": [2, 3, 4, 9, 11], "thi": [2, 3, 4, 5, 8, 9, 10, 11, 12], "thin": 8, "thread": 2, "threadpoolexecutor": 9, "three": [2, 5, 8, 9], "threshold": [1, 12], "through": [2, 3, 5, 9, 11, 12], "throughout": 11, "throughput": [4, 10, 12], "thumb": 4, "time": [2, 8, 9, 12], "timestamp": [2, 11, 12], "tip": [5, 6], "tmp": [3, 7], "to_byt": 11, "tobyt": 11, "togeth": [2, 4], "token": [1, 2, 3, 4, 5, 8, 12], "token_id": [2, 11, 12], "tokenidprocessor": 2, "tokenized_request": 12, "tool": [6, 12], "top": [1, 2, 5, 8, 9], "top_k": [1, 8], "top_p": [1, 12], "topk_group": 9, "topk_id": 5, "topk_indices_buff": 9, "topk_softmax": 8, "topk_weight": 5, "torch": [2, 3, 4, 5, 8, 12], "torch_compile_cach": 3, "torch_dtyp": 4, "torch_profiler_dir": [4, 12], "torchcompilewrapperwithcustomdispatch": 3, "torchdynamo": 4, "torchinductor": 4, "total": [2, 4, 5, 11, 12], "total_accepted_token": [11, 12], "total_draft_token": [11, 12], "total_seqs_num": 11, "total_seqs_num_decod": 11, "total_seqs_num_prefil": 11, "total_token": 12, "total_tokens_num": 11, "total_tokens_num_decod": 11, "total_tokens_num_prefil": 11, "tp": [2, 4, 6, 8, 9, 12], "tp_dim": [5, 8], "tp_rank": [5, 8], "tp_size": [5, 8], "tp_size_": 5, "tpot": [2, 12], "tpot_": 12, "trace": [3, 4, 8, 12], "track": [2, 5, 12], "traffic": 8, "train": 6, "transform": 9, "transformerblock": 9, "transit": 2, "translat": 9, "treat": 4, "tree": 6, "trick": 8, "trigger": [4, 5, 11, 12], "triton": [3, 4, 9, 12], "triton_kernel": 8, "triton_kernel_moe_forward": 8, "troubleshoot": 6, "trt": 12, "true": [0, 3, 4, 5, 8, 9, 11, 12], "trust": [4, 5, 12], "trust_remote_cod": [0, 4], "ttft": [2, 5, 11, 12], "ttft_": 12, "tuned_gemm": 8, "tupl": [3, 9, 11], "turn": 2, "two": [9, 11], "txt": 7, "type": [2, 3, 4, 5, 8, 11, 12], "typic": [4, 9], "typo": 3, "ulimit": 12, "unconfin": 12, "under": [3, 8], "understand": 10, "unhash": 11, "unifi": 8, "unified_attent": 8, "unified_attention_with_output": [3, 4], "unified_attention_with_output_bas": 8, "uniform": 3, "union": [3, 4], "uniqu": [2, 11, 12], "unix": 12, "unless": 4, "unpack": 3, "unquant": 8, "unquantizedfusedmoemethod": 8, "unreach": 8, "unset": 4, "until": [2, 8, 11, 12], "up": [2, 3, 5, 8, 9, 11], "up_proj": 9, "updat": [3, 11], "update_spec_stat": 11, "url": 12, "us": [2, 3, 5, 8, 9, 10, 11, 12], "usag": [1, 4, 5, 9], "use_all2all_kernel": [5, 8], "use_cudagraph": [3, 4], "use_custom_dispatch": 3, "use_ep": [5, 8], "use_grouped_topk": 8, "use_inductor": [3, 4], "use_mla": 8, "use_mori_kernel": 8, "use_qk_norm": 9, "use_spec": 11, "use_triton_attn": 8, "used_block_id": 11, "user": [2, 4, 12], "util": [2, 3, 5, 9, 12], "uuid": 12, "uvicorn": 12, "v": [3, 4, 5, 8, 9, 11, 12], "v0": 0, "v1": 12, "v3": [4, 8], "v_head_dim": 8, "v_proj": 9, "valid": [6, 11], "valu": [9, 11, 12], "valueerror": 4, "var": [4, 12], "variabl": [3, 6, 9, 12], "variant": [2, 8, 9], "variat": [8, 12], "verif": 6, "verifi": [2, 3, 7, 11, 12], "version": [3, 7], "via": [2, 3, 4, 5, 8, 9, 11, 12], "video": [7, 12], "view": 12, "visibl": 3, "vllm": [2, 12], "vllm_compile_cach": 3, "vllm_config": 3, "vocab": 8, "vocab_end_idx": 8, "vocab_start_idx": 8, "vocabparallelembed": 9, "vocabulari": 8, "w1": 9, "w13_weight": 9, "w2": 9, "w3": 9, "wa": 11, "wai": 12, "wait": [2, 5, 11], "want": 3, "warmup": [3, 11, 12], "warp_per_block": 5, "weight": [4, 6, 12], "weight_block_s": 4, "weight_dtyp": 4, "weight_load": 9, "weight_nam": 9, "weight_scal": 9, "weight_scale_inv": 9, "weight_util": 9, "weights_map": 9, "were": 11, "when": [2, 3, 4, 5, 8, 9, 11, 12], "where": [3, 4, 8, 9, 11], "whether": [1, 3, 4, 5, 8, 11, 12], "which": [2, 3, 8, 9, 11], "while": [2, 3, 5, 8, 11, 12], "whole": 3, "whose": 11, "wide": [0, 6], "window": 9, "wise": 9, "with_stack": [4, 12], "within": [2, 3, 4, 11], "without": [2, 3, 4, 8, 12], "work": [2, 5], "worker": [2, 12], "workflow": 12, "workload": [3, 4, 5, 10, 12], "world": [10, 12], "world_siz": 4, "world_size_across_dp": 4, "would": 3, "wrap": [3, 8, 9], "wrapper": [3, 8, 9], "write": [8, 9, 12], "written": 12, "x": [4, 8, 12], "x_first_half": 8, "x_pad_to_multipl": [8, 9], "x_scale": 8, "x_second_half": 8, "xxh64": 11, "xxhash": 11, "xxhash64": 11, "y": 5, "ye": [3, 4, 9], "you": [4, 10, 12], "your": [3, 4, 7, 9, 10, 12], "zero": [8, 11], "zmq": [2, 5]}, "titles": ["Supported Models", "Serving API", "ATOM Architecture Guide", "ATOM Compilation &amp; CUDA Graphs Guide", "ATOM Configuration Guide", "ATOM Distributed Inference Guide", "ATOM Documentation", "Installation", "ATOM Model Operations Guide", "ATOM Model Support Guide", "Quickstart", "ATOM Scheduling &amp; KV Cache Guide", "ATOM Serving &amp; Benchmarking Guide"], "titleterms": {"0": 3, "1": [2, 3, 4, 5, 8, 9, 11, 12], "10": 8, "2": [2, 3, 4, 5, 8, 9, 11, 12], "235b": 5, "3": [2, 3, 4, 5, 8, 9, 11, 12], "4": [2, 3, 4, 5, 8, 9, 11, 12], "5": [2, 3, 4, 5, 8, 9, 11, 12], "6": [2, 3, 4, 5, 8, 11, 12], "7": [3, 4, 8, 11, 12], "8": [3, 4, 5, 8, 11, 12], "9": [4, 8], "It": 12, "a22b": 5, "abstract": 8, "accept": 11, "accuraci": 12, "activ": 8, "ad": 9, "addit": 4, "aiter": [4, 8], "algorithm": 11, "alloc": 11, "allreduc": 5, "api": [1, 6, 10, 12], "append": 11, "architectur": [0, 2, 5, 9, 12], "argument": [4, 12], "assign": 5, "asynchron": 12, "atom": [2, 3, 4, 5, 6, 8, 9, 11, 12], "attent": [5, 8], "attention_mha": 8, "attention_mla": 8, "auto": 4, "backend": [3, 8, 12], "base": 8, "base_attent": 8, "batch": [5, 10], "benchmark": 12, "beyond": 9, "block": 11, "blockmanag": 11, "busi": 5, "cach": [3, 8, 9, 11], "can": 11, "captur": 3, "causallm": 9, "chain": [8, 11], "check": 11, "choos": 4, "class": [1, 8, 9, 11], "cleanup": 11, "cli": [4, 12], "combin": 5, "common": 3, "commun": 5, "compat": 12, "compil": [3, 4], "compilationconfig": 4, "compilationlevel": 4, "compilerinterfac": 3, "compilermanag": 3, "compon": 2, "comput": 11, "condit": 11, "config": [4, 8], "configur": [0, 3, 4, 5, 12], "constructor": 11, "context": [2, 3], "core": [11, 12], "coremanag": 5, "count": 11, "creat": 9, "cuda": [3, 4], "cudagraphmod": 4, "curl": 12, "custom": 3, "data": 5, "dataclass": 3, "dealloc": 11, "decis": [3, 4], "decod": [4, 11, 12], "decor": 3, "deepseek": [5, 9], "deepseekmtp": 9, "deepseekv2forcausallm": 9, "default": 3, "delai": 11, "dens": 5, "deploy": [5, 12], "detail": 9, "detect": 4, "devic": 5, "dispatch": [3, 8], "distribut": [5, 10], "docker": [7, 12], "document": 6, "doe": 12, "dp": 5, "dpmetadata": 5, "draft": 11, "dtype": 4, "dummi": 5, "dure": [11, 12], "dynamo_as_i": 3, "dynamo_onc": 3, "embed": 8, "embed_head": 8, "enabl": 11, "endpoint": 12, "engin": 12, "enginearg": [4, 12], "enum": 11, "env": 4, "environ": [4, 5, 7], "ep": 5, "evalu": 12, "exampl": [1, 5, 12], "execut": 5, "expert": [5, 8], "extens": 11, "factor": 11, "factori": 8, "fallback": 8, "featur": 6, "field": [3, 4, 11], "file": [2, 3, 4, 5, 8, 9, 11, 12], "flow": [3, 9, 11], "forward": [2, 3], "forwardcontext": 3, "from": [4, 7], "full": [3, 12], "full_and_piecewis": 3, "full_decode_onli": 3, "function": [8, 9, 11, 12], "fuse": [8, 9], "fused_mo": 8, "fused_moe_triton": 8, "fusedmo": 8, "fusedmoeparallelconfig": [5, 8], "fusion": 9, "gener": [1, 12], "get": 6, "get_quant_config": 4, "get_rop": 8, "glm4": 9, "glm4moeforcausallm": 9, "gpt": [0, 9], "gptossforcausallm": 9, "gpu": [5, 6, 12], "graph": [3, 4], "group": 5, "guid": [2, 3, 4, 5, 6, 8, 9, 11, 12], "handl": 9, "hash": 11, "head": 8, "help": 6, "helper": 3, "hierarchi": 8, "how": 12, "http": 12, "huggingfac": 4, "implement": 9, "indic": 6, "inductoradaptor": 3, "inductorstandaloneadaptor": 3, "infer": [5, 10, 12], "initi": [5, 11, 12], "input": 9, "insert": 11, "instal": 7, "integr": [3, 8, 11], "k2": 5, "kei": [3, 12], "kernel": 8, "kimi": 5, "kv": [8, 11], "latent": 8, "layer": 9, "layernorm": 8, "level": [3, 4], "lifecycl": [2, 3, 11], "linear": 8, "link": 6, "llama": [0, 9], "llamaforcausallm": 9, "llm": 1, "llmengin": 12, "load": 9, "lookup": 11, "loop": 5, "mai": 11, "manag": [3, 11], "map": 8, "master": 4, "method": [1, 3, 7, 8, 12], "metric": 12, "mixtral": [0, 9], "mixtralforcausallm": 9, "mixtur": 8, "mla": 9, "mode": [3, 4, 5], "model": [0, 5, 8, 9, 10, 12], "model_op": 8, "moe": [5, 8, 9], "mori": [5, 8], "mori_prepare_fin": 8, "mtp": [9, 12], "mul": 9, "multi": [2, 5, 8, 9, 12], "new": 9, "next": 10, "no_compil": 3, "none": 3, "norm": 9, "normal": 8, "num_hidden_lay": 9, "num_token": 11, "offlin": 12, "onli": 5, "onlin": 12, "op": 3, "openai": 12, "oper": [3, 8], "optim": 9, "option": 3, "orchestr": 5, "oss": 9, "other": 0, "output": [8, 11], "outsid": 4, "overview": [2, 8], "parallel": [4, 5, 8, 12], "parallelconfig": 4, "parallellmhead": 8, "paramet": 4, "pattern": 2, "perform": [0, 10], "piecewis": 3, "pipelin": 3, "placehold": 11, "pool": 3, "posit": 8, "postprocess": 11, "predict": 9, "preemption": 11, "prefix": 11, "process": [2, 5, 8], "product": 3, "profil": 12, "programmat": 12, "properti": 11, "py": [4, 8], "qk": 9, "quant": 9, "quantiz": [0, 4, 8], "quantizationconfig": 4, "quanttyp": 4, "quick": [4, 5, 6, 8, 9, 11, 12], "quickstart": 10, "qwen3": [5, 9], "qwen3forcausallm": 9, "qwen3moeforcausallm": 9, "r1": 5, "refer": [4, 5, 6, 8, 9, 11, 12], "regist": [4, 9], "registr": 3, "reject": 12, "rejection_sampl": 8, "rejectionsampl": 8, "replai": 3, "request": [2, 12], "requestoutput": 1, "requir": 7, "respons": 12, "rmsnorm": [8, 9], "rope": [8, 9], "rotari": 8, "rotary_embed": 8, "rotaryembed": 8, "rout": 8, "run": 12, "run_model": 3, "sampl": [4, 8, 12], "sampler": 8, "samplingparam": [1, 4, 12], "schedul": 11, "scheduledbatch": 11, "scheduledbatchoutput": 11, "script": 12, "sequenc": [2, 11], "sequencestatu": 11, "sequencetyp": 11, "serv": [1, 10, 12], "server": [10, 12], "setter": 11, "setup": 12, "shard": [5, 8], "share": 3, "signatur": [9, 11], "silu": 9, "siluandmul": 8, "simpl": 12, "singl": 12, "size": [0, 3], "sourc": [2, 3, 4, 5, 7, 8, 9, 11, 12], "specif": 9, "specul": [4, 11, 12], "speculativeconfig": 4, "split": 3, "start": 6, "startup": 12, "stateless": 3, "statist": [11, 12], "step": [9, 10], "stop": 11, "storag": 11, "strategi": 5, "stream": [11, 12], "structur": 11, "support": [0, 4, 6, 9], "support_torch_compil": 3, "synchron": [5, 12], "system": 2, "tabl": [6, 8], "tensor": [5, 8, 12], "think": 5, "throughput": 5, "time": 11, "tip": 10, "token": [9, 11], "topk": 8, "tp": 5, "tp4": 5, "tp8": 5, "track": 11, "tree": [3, 4], "triton": 8, "troubleshoot": 7, "us": 4, "usag": 12, "user": 6, "util": [4, 8], "v2": 9, "v3": 9, "valid": 12, "valu": [3, 4], "variabl": [4, 5, 7], "verif": 7, "vllmbackend": 3, "vocabparallelembed": 8, "weight": [5, 8, 9], "what": 12, "work": 12}})